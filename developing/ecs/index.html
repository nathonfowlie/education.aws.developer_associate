
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Study notes for the AWS Developer Associate 2021 Exam." name="description"/>
<meta content="Nathon Fowlie" name="author"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-7.1.5" name="generator"/>
<title>ECS - AWS Developer Associate 2021</title>
<link href="../../assets/stylesheets/main.bde7dde4.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.ef6f36e2.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
<link href="../../css/extra.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="" data-md-color-primary="" data-md-color-scheme="default" dir="ltr">
<script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#ecs">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="AWS Developer Associate 2021" class="md-header__button md-logo" data-md-component="logo" href="../.." title="AWS Developer Associate 2021">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            AWS Developer Associate 2021
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              ECS
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input class="md-option" data-md-color-accent="" data-md-color-media="" data-md-color-primary="" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"></path></svg>
</label>
<input class="md-option" data-md-color-accent="" data-md-color-media="" data-md-color-primary="" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/nathonfowlie/education.aws.developer_associate/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"></path></svg>
</div>
<div class="md-source__repository">
    nathonfowlie/education.aws.developer_associate
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="AWS Developer Associate 2021" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="AWS Developer Associate 2021">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
    AWS Developer Associate 2021
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/nathonfowlie/education.aws.developer_associate/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"></path></svg>
</div>
<div class="md-source__repository">
    nathonfowlie/education.aws.developer_associate
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
        Home
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
        CI/CD
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="CI/CD" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          CI/CD
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../cicd/codebuild/">
        CodeBuild
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cicd/codecommit/">
        CodeCommit
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cicd/codedeploy/">
        CodeDeploy
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cicd/codepipeline/">
        CodePipeline
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cicd/codestar/">
        CodeStar
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
        Developing on AWS
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Developing on AWS" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Developing on AWS
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../appsync/">
        AppSync
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../athena/">
        Athena
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cli/">
        Command Line Interface (CLI)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cloudformation/">
        CloudFormation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cloudfront/">
        CloudFront
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cloudtrail/">
        CloudTrail
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cloudwatch/">
        CloudWatch
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ds/">
        Directory Services
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dynamodb/">
        DynamoDB
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ecr/">
        ECR
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          ECS
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        ECS
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
    Overview
  </a>
<nav aria-label="Overview" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ecs-classic">
    ECS Classic
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ecs-clusters">
    ECS Clusters
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ecs-task-definition">
    ECS Task Definition
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ecs-service">
    ECS Service
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ecs-service-with-load-balancer">
    ECS Service with Load Balancer
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ecs-data-volumes">
    ECS Data Volumes
  </a>
<nav aria-label="ECS Data Volumes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#task-strategies">
    Task Strategies
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#alb">
    ALB
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nlb">
    NLB
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#classic-load-balancer">
    Classic Load Balancer
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#iam-roles">
    IAM Roles
  </a>
<nav aria-label="IAM Roles" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#aws-service-role-for-ecs">
    AWS Service role for ECS
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec2-instance-role">
    EC2 Instance Role
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ecs-service-role">
    ECS Service Role
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ecs-container-service-autoscaling-role">
    ECS Container Service Autoscaling Role
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ecs-service-task-role">
    ECS Service Task Role
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#task-placement-constraints">
    Task Placement &amp; Constraints
  </a>
<nav aria-label="Task Placement &amp; Constraints" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#task-placement-strategies">
    Task Placement Strategies
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#task-placement-contraints">
    Task Placement Contraints
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#service-auto-scaling">
    Service Auto-scaling
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cluster-capacity-provider">
    Cluster Capacity Provider
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ecs-logging">
    ECS Logging
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../elasticbeanstalk/">
        Elastic Beanstalk
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../fargate/">
        Fargate
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sdk/">
        AWS SDK
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../stepfunctions/">
        Step Functions
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sts/">
        STS
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../xray/">
        X-Ray
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
        Fundamentals
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Fundamentals" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Fundamentals
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/acm/">
        AWS Certificate Manager (ACM)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/asg/">
        Auto-Scaling Groups
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/aurora/">
        Aurora
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/databases/">
        Databases
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/ebs/">
        EBS
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/ec2/">
        EC2
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/efs/">
        Elastic File System
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/elasticache/">
        ElastiCache
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/elb/">
        Elastic Load Balancer
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/iam/">
        Identity &amp; Access Management
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/rds/">
        Relational Database Service
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/route53/">
        Route53
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/s3/">
        Simple Storage Service (S3)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/ses/">
        Simple Email Service (SES)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fundamentals/vpc/">
        VPC
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../identitymanagement/cognito/">
        Cognito
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6">
        Messaging
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Messaging" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          Messaging
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../messaging/kinesis/">
        Kinesis
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../messaging/sns/">
        Simple Notification Service (SNS)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../messaging/sqs/">
        Simple Queue Service
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7">
        Security
        <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Security" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
          Security
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../security/kms/">
        AWS Key Management Service (KMS)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../security/secrets_manager/">
        Secrets Manager
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../security/ssm/">
        SSM Parameter Store
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/nathonfowlie/education.aws.developer_associate/edit/master/docs/developing/ecs.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="ecs">ECS<a class="headerlink" href="#ecs" title="Permanent link">¶</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">¶</a></h2>
<p>Three different flavours -</p>
<table>
<thead>
<tr>
<th>Flavour</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ECS Classic</td>
<td>Provision EC2 instances to run containers on.</td>
</tr>
<tr>
<td>Fargate</td>
<td>Serverless.</td>
</tr>
<tr>
<td>EKS</td>
<td>Managed Kubernetes by AWS.</td>
</tr>
</tbody>
</table>
<h3 id="ecs-classic">ECS Classic<a class="headerlink" href="#ecs-classic" title="Permanent link">¶</a></h3>
<ul>
<li>EC2 instances must be created.</li>
<li>Must configure ECS_CLUSTER in /etc/ecs/ecs.config to provide the cluster name.</li>
<li>Must configure EC_ENABLE_TASK_IAM_ROLE in /etc/ecs/ecs.config to allow the ECS task to endorse an IAM role.</li>
<li>EC2 instances must run an ECS agent.</li>
<li>EC2 instance can run multiple containers of the same type, by NOT specifying a host port and using an ALB with dynamic port mapping.</li>
<li>EC2 instance needs to allow traffic from the ALB on all ports.</li>
<li>ECS tasks must have IAM roles to execute actions against AWS.</li>
<li>Security groups operate at the instance level, not the task level.</li>
</ul>
<h2 id="ecs-clusters">ECS Clusters<a class="headerlink" href="#ecs-clusters" title="Permanent link">¶</a></h2>
<ul>
<li>Logical grouping of EC2 instances.</li>
<li>Each EC2 instance runs the ECS agent (docker container).</li>
<li>Each ECS agent registers itself to the ECS cluster.</li>
<li>EC2 instances use a special AMI made specifically for ECS.</li>
<li>3 cluster creation templates</li>
<li>Networking only (use Fargate)</li>
<li>EC2 Linux + Networking (uses auto-scaling)</li>
<li>EC2 Windows + Networking (uses auto-scaling)</li>
</ul>
<h2 id="ecs-task-definition">ECS Task Definition<a class="headerlink" href="#ecs-task-definition" title="Permanent link">¶</a></h2>
<ul>
<li>JSON metadata that tells ECS how to run a docker container.</li>
<li>Includes image name, port binding for container/host, memory/cpu requirements, env vars, network info + more.</li>
<li>Need to assign an IAM role to allow it to make API requests to AWS services.</li>
<li>Are versioned.</li>
</ul>
<h2 id="ecs-service">ECS Service<a class="headerlink" href="#ecs-service" title="Permanent link">¶</a></h2>
<ul>
<li>Defines how many/what tasks should be run.</li>
<li>Can be linked to ELB/NLB/ALB if needed.</li>
<li>Assign the task definition, and it's revision (version).</li>
<li>Set minimum healthy percent to 0 to allow for rolling restarts.</li>
<li>Can use Code Deploy to deploy to ECS (blue/green deployment), as an alternative to a rolling deployment.</li>
<li>Can use placement strategies to control where the tasks are placed.</li>
<li>Supports integration with service discovery.</li>
<li>Supports auto-scaling.</li>
<li>Two service types - daemon good for monitoring services, or replica, for 'normal' clustered containers.</li>
<li>Needs a Service IAM role to allow it to communicate with the API. Role can be auto-created at the time of service creation.</li>
</ul>
<h2 id="ecs-service-with-load-balancer">ECS Service with Load Balancer<a class="headerlink" href="#ecs-service-with-load-balancer" title="Permanent link">¶</a></h2>
<ul>
<li>Use ALB with dynamic port forwarding.</li>
<li>Only specify the container port in the task definition to use a random port (bridge networking).</li>
<li>Load balancer can only be added during service creation.</li>
<li>Have to create the load balancer before configuring the service.</li>
<li>The security group used by the clusters EC2 instances, needs an inbound rule that permits all traffic on any port, coming from the ALB security group. This will allow the load balancer to forward traffic via the dynamically mapped ports.</li>
</ul>
<h2 id="ecs-data-volumes">ECS Data Volumes<a class="headerlink" href="#ecs-data-volumes" title="Permanent link">¶</a></h2>
<h3 id="task-strategies">Task Strategies<a class="headerlink" href="#task-strategies" title="Permanent link">¶</a></h3>
<h4 id="shared-ebs-volume">Shared EBS Volume<a class="headerlink" href="#shared-ebs-volume" title="Permanent link">¶</a></h4>
<ul>
<li>Share an EBS volume between EC2 instances.</li>
<li>Allows the docker containers to mount the EBS volume and increases storage capacity of the task.</li>
<li>If the task moves to another EC2 instance in another availability zone, it won't have the same EBS volume/data.</li>
</ul>
<h4 id="shared-efs-volume">Shared EFS Volume<a class="headerlink" href="#shared-efs-volume" title="Permanent link">¶</a></h4>
<ul>
<li>Share an EFS volume between EC2 instances.</li>
<li>Same EFS volume can mounted on tasks in any availability zone.</li>
<li>Persistent, multi-AZ storage for containers.</li>
<li>Fargate+EFS allows for data storage without the need for servers.</li>
</ul>
<h4 id="bind-mounts">Bind Mounts<a class="headerlink" href="#bind-mounts" title="Permanent link">¶</a></h4>
<ul>
<li>Use local EC2 instance storage for EC2 Tasks, or Fargate tasks (4G storage).</li>
<li>Useful to store ephemeral data on the same task.</li>
<li>Good for side-car pattern. Container A writes application logs to storage, Container B ingests the logs/metrics and forwards them to Splunk/Prometheus etc.</li>
<li>ALB access logs will contain information about latency, URLs, status codes and client IPs.</li>
</ul>
<h3 id="alb">ALB<a class="headerlink" href="#alb" title="Permanent link">¶</a></h3>
<ul>
<li>Uses dynamic port forwarding to forward to the task instances running in swarm mode.</li>
<li>Rule-based routing &amp; paths supported.</li>
<li>Define the listener port, protocol, target group name, target protocol (http, https etc), path (/ to handle all requests for all urls), and health check path.</li>
</ul>
<h3 id="nlb">NLB<a class="headerlink" href="#nlb" title="Permanent link">¶</a></h3>
<ul>
<li>Uses flow hashing route algorithm to direct traffic to one of the task instances.</li>
<li>Uses the target group defined in the NLB.</li>
</ul>
<h3 id="classic-load-balancer">Classic Load Balancer<a class="headerlink" href="#classic-load-balancer" title="Permanent link">¶</a></h3>
<ul>
<li>Uses statically defined host port mappings. One task per container instance.</li>
<li>Rule-based routing or paths not supported.</li>
</ul>
<h2 id="iam-roles">IAM Roles<a class="headerlink" href="#iam-roles" title="Permanent link">¶</a></h2>
<h3 id="aws-service-role-for-ecs">AWS Service role for ECS<a class="headerlink" href="#aws-service-role-for-ecs" title="Permanent link">¶</a></h3>
<ul>
<li>Allow the ECS service to create/manage resources (setup load balancers, route53 etc).</li>
</ul>
<h3 id="ec2-instance-role">EC2 Instance Role<a class="headerlink" href="#ec2-instance-role" title="Permanent link">¶</a></h3>
<ul>
<li>Allow EC2 instances in an ECS cluster to access ECS (register with load balancers etc).</li>
<li>Attached to EC2 instance(s).</li>
<li>Allows the ECS agent to function correctly (make API calls to the ECS service, send container logs to CloudWatch, and pull images from ECR).</li>
</ul>
<h3 id="ecs-service-role">ECS Service Role<a class="headerlink" href="#ecs-service-role" title="Permanent link">¶</a></h3>
<ul>
<li>Allows ECS to create and manage AWS resources (setup load balancers, route53 etc).</li>
</ul>
<h3 id="ecs-container-service-autoscaling-role">ECS Container Service Autoscaling Role<a class="headerlink" href="#ecs-container-service-autoscaling-role" title="Permanent link">¶</a></h3>
<ul>
<li>Allow auto-scaling to access and update ECS services.</li>
</ul>
<h3 id="ecs-service-task-role">ECS Service Task Role<a class="headerlink" href="#ecs-service-task-role" title="Permanent link">¶</a></h3>
<ul>
<li>Controls what resources the task can/can't access.</li>
</ul>
<h2 id="task-placement-constraints">Task Placement &amp; Constraints<a class="headerlink" href="#task-placement-constraints" title="Permanent link">¶</a></h2>
<ul>
<li>Only for ECS using EC2. Fargate will figure it out for you.</li>
<li>Based on best effort only.</li>
<li>Uses the workflow -</li>
<li>Find instances that meet CPU, memory &amp; port requirements in the task definition.</li>
<li>Find instances that meet task placement constraints.</li>
<li>Find instances that satisfy task placement strategies.</li>
<li>Selet the instance for task placement.</li>
</ul>
<h3 id="task-placement-strategies">Task Placement Strategies<a class="headerlink" href="#task-placement-strategies" title="Permanent link">¶</a></h3>
<p>Multiple strategies can be mixed together. For example, spread the containers out across all availability zones, but binpack them together to maximum EC2 instance utilisation in each zone.</p>
<table>
<thead>
<tr>
<th>strategy</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>binpack</td>
<td>Places tasks based on the least available amount of CPU or memory, to maximise EC2 instance utilisation and reduce costs.</td>
</tr>
<tr>
<td>random</td>
<td>Places tasks randomly.</td>
</tr>
<tr>
<td>spread</td>
<td>Place tasks based on a specified value - instance id, availability zone etc.</td>
</tr>
</tbody>
</table>
<h3 id="task-placement-contraints">Task Placement Contraints<a class="headerlink" href="#task-placement-contraints" title="Permanent link">¶</a></h3>
<table>
<thead>
<tr>
<th>constraint</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>distinctInstance</td>
<td>Place each task on a different container instance.</td>
</tr>
<tr>
<td>memberOf</td>
<td>Place task on instances that satisfy an expression, using Cluster Query Language (CQL).</td>
</tr>
</tbody>
</table>
<h2 id="service-auto-scaling">Service Auto-scaling<a class="headerlink" href="#service-auto-scaling" title="Permanent link">¶</a></h2>
<ul>
<li>Different to EC2 auto-scaling.</li>
<li>Fargate auto-scaling is way easier.</li>
</ul>
<p>| Scaling method    | Description                               |
| TargetTracking    | Scale based on average CloudWatch metric. |
| Step Scaling      | Scale based on CloudWatch alarms.         |
| Scheduled Scaling | Scale based on predictable changes.       |</p>
<h2 id="cluster-capacity-provider">Cluster Capacity Provider<a class="headerlink" href="#cluster-capacity-provider" title="Permanent link">¶</a></h2>
<ul>
<li>Will provision infrastructure for you (scale EC2 instances, ECS task instances and Fargate instances).</li>
<li>The FARGATE and FARGATE_SPOT capacity providers are added automatically of ECS and Fargate users.</li>
<li>For Amazon ECS on EC2, the capacity provider needs to be associated with an auto-scaling group.</li>
</ul>
<h2 id="ecs-logging">ECS Logging<a class="headerlink" href="#ecs-logging" title="Permanent link">¶</a></h2>
<ul>
<li>CloudWatch logging is defined in the task definition.</li>
<li>Different log stream per container.</li>
<li>EC2 instance profile needs the right IAM permissions to talk to CloudWatch.</li>
</ul>
<hr/>
<div class="md-source-date">
<small>
    
      Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">June 30, 2021</span>
</small>
</div>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" data-md-state="hidden" href="#" title="Back to top">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path></svg>
</a>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a class="md-footer__link md-footer__link--prev" href="../ecr/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              ECR
            </div>
</div>
</a>
<a class="md-footer__link md-footer__link--next" href="../elasticbeanstalk/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Elastic Beanstalk
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
<div class="md-footer-social">
<a class="md-footer-social__link" href="https://www.linkedin.com/in/nathonfowlie/" rel="noopener" target="_blank" title="LinkedIn">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.top", "search.suggest", "toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.d351de03.min.js", "version": null}</script>
<script src="../../assets/javascripts/bundle.a1609d9a.min.js"></script>
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</body>
</html>